<!-- ============================================================================ -->
<!-- DragonSurvival ÂÖºÂÆπÊÄßÂàÜÊîØ / DragonSurvival Compatibility Fork                -->
<!-- ============================================================================ -->

> [!IMPORTANT]
> **Ê≠§ÂàÜÊîØÊ∑ªÂä†‰∫Ü DragonSurvival Ê®°ÁªÑÊîØÊåÅ** / **This fork adds DragonSurvival mod support**
> 
> Â¶ÇÊûú‰Ω†Âú®‰ΩøÁî® DragonSurvival Ê®°ÁªÑÔºåËØ∑‰ΩøÁî®Ê≠§ÁâàÊú¨ÔºÅ
> If you are using DragonSurvival mod, use this version!

## üêâ DragonSurvival ÂÖºÂÆπÊÄß / DragonSurvival Compatibility

### Âø´ÈÄüÈ¢ÑËßà / Quick Preview

#### ÈæôÈ£ûË°å HUD ÊºîÁ§∫ / Dragon Flight HUD Demo

> **Ê≥®ÊÑè / Note:** Â¶ÇÊûúËßÜÈ¢ëÊó†Ê≥ïÂä†ËΩΩÔºåËØ∑Êü•Áúã [images ÁõÆÂΩï](images/) ‰∏≠ÁöÑÊú¨Âú∞Êñá‰ª∂„ÄÇ
> If videos fail to load, check the local files in [images directory](images/).

| Ëµ∑È£ûÊºîÁ§∫ / Takeoff Demo | ÊªëÁøîÊºîÁ§∫ / Gliding Demo | ÂÆåÊï¥È£ûË°å / Full Flight |
|------------------------|------------------------|----------------------|
| <video src="https://github.com/Octol1ttle/FlightAssistant/raw/dev/images/2026-02-19%2013-53-37-00.00.10.700-00.00.19.497-seg2.mp4" width="200" /> | <video src="https://github.com/Octol1ttle/FlightAssistant/raw/dev/images/2026-02-19%2013-53-37-00.00.27.167-00.00.33.667-seg3.mp4" width="200" /> | <video src="https://github.com/Octol1ttle/FlightAssistant/raw/dev/images/2026-02-19%2013-53-37-00.00.58.067-00.01.12.983-seg1.mp4" width="200" /> |

#### Á≥ªÁªüÊû∂ÊûÑÂõæ / System Architecture

![System Architecture](images/diagram.png)

#### ÂäüËÉΩÁâπÊÄß / Features

- ‚úÖ **ÈæôÈ£ûË°åÁä∂ÊÄÅÊ£ÄÊµã** - Ëá™Âä®ËØÜÂà´ÈæôÁöÑÈ£ûË°å/ÊªëÁøîÁä∂ÊÄÅ
- ‚úÖ **ÂÆåÊï¥ HUD ÊîØÊåÅ** - Á©∫ÈÄü‰ª™„ÄÅÈ´òÂ∫¶Ë°®„ÄÅÈ£ûË°åËΩ®ËøπÈ¢ÑÊµã
- ‚úÖ **Ëá™Âä®Ê®°ÂºèÂàáÊç¢** - Âú∞Èù¢ ‚Üî È£ûË°å Ëá™Âä®ÂàáÊç¢ÊòæÁ§∫Ê®°Âºè
- ‚úÖ **ÈÄüÂ∫¶Âπ≥ÊªëÂ§ÑÁêÜ** - FIR Êª§Ê≥¢Âô®Ê∂àÈô§ HUD ÊäñÂä®
- ‚úÖ **Êó†ÈúÄÈÖçÁΩÆ** - Ëá™Âä®Ê£ÄÊµã DragonSurvival Âπ∂ÂêØÁî®ÊîØÊåÅ

#### ÂÆâË£ÖË¶ÅÊ±Ç / Requirements

| ÂøÖÈúÄ / Required | ÂèØÈÄâ / Optional |
|----------------|-----------------|
| DragonSurvival | YACL (ÈÖçÁΩÆÁïåÈù¢) |
| GeckoLib | |
| Architectury API | |
| KFF (NeoForge) / FLK (Fabric) | |

> [!WARNING]
> **‰∏çÂÖºÂÆπÊÄßË≠¶Âëä / Incompatibility Warning**
> - ‚ùå ‰∏çËÉΩ‰∏éÂéüÁâà FlightAssistant ÂÖ±Â≠ò
> - ‚ùå ÊúçÂä°Âô®ÂøÖÈ°ªÂÆâË£Ö DragonSurvival ÊâçËÉΩÊòæÁ§∫ÈæôÈ£ûË°å HUD
> 
> - Cannot coexist with vanilla FlightAssistant
> - Server must have DragonSurvival for dragon flight HUD

---

## ÂéüÁâà FlightAssistant / Original FlightAssistant

<p align=center>
    <img src="images/logo.png">
</p>

<p align=center>
    <a href="https://modrinth.com/mod/flightassistant">
        <img src="https://cdn.jsdelivr.net/npm/@intergrav/devins-badges@3.2.0/assets/cozy/available/modrinth_vector.svg"
            alt="Available on Modrinth"></a>
    <a href="https://modrinth.com/mod/fabric-api/">
        <img src="https://cdn.jsdelivr.net/npm/@intergrav/devins-badges@3.2.0/assets/cozy/requires/fabric-api_vector.svg"
            alt="Requires Fabric API"></a>
    <a href="https://modrinth.com/mod/flightassistant/versions?l=forge&l=neoforge">
        <img src="https://cdn.jsdelivr.net/npm/@intergrav/devins-badges@3.2.0/assets/cozy/supported/forge_vector.svg"
            alt="Available for Forge"></a>
    <a href="https://discord.gg/5kcBCvnbTp">
        <img src="https://cdn.jsdelivr.net/npm/@intergrav/devins-badges@3.2.0/assets/cozy/social/discord-plural_vector.svg"
            alt="Chat with us on Discord"></a>
</p>

---

**FlightAssistant** is a powerful client-side mod that adds fully configurable full-fledged avionics, situational awareness tools and advanced automation to Minecraft elytras, while still being friendly to casual users.

## Main Features

- Fully customizable flight HUD ([wiki](https://github.com/Octol1ttle/FlightAssistant/wiki/HUD))
  - An informative display showing flight data in real time
    <img src="https://github.com/Octol1ttle/FlightAssistant/wiki/img/hud/full_screenshot_alt.png">
- Smart flight safety alerts ([wiki](https://github.com/Octol1ttle/FlightAssistant/wiki/Alerts))
  - Be aware of unsafe flight conditions before it's too late
    <img src="https://github.com/Octol1ttle/FlightAssistant/wiki/img/hud/alert_display_alt.png">
- Non-intrusive automatic flight protections ([wiki](https://github.com/Octol1ttle/FlightAssistant/wiki/Flight-protections))
  - When you're not paying attention, FlightAssistant will protect you
  - Examples: ground collision damage avoidance, void damage avoidance, automatic elytra deploying
- Advanced autopilot with flight planning capabilities: fly safely completely hands-free ([wiki](https://github.com/Octol1ttle/FlightAssistant/wiki/Autopilot%3A-overview-and-basics))
  - Flight plans can be saved to disk and loaded later
  - With flight plans, a flight can be performed completely automatically from takeoff to landing
    <img src="https://github.com/Octol1ttle/FlightAssistant/wiki/img/hud/full_screenshot.png">

### Known Issues & Limitations

#### ‚ö†Ô∏è Incompatibilities

1. **Cannot coexist with vanilla FlightAssistant**
   - This fork modifies core flight detection logic
   - Installing both will cause conflicts
   - **Solution:** Use only this fork or the original, not both

2. **Server-side requirements**
   - DragonSurvival must be installed on the server
   - FlightAssistant is client-side only
   - Server without DragonSurvival = no dragon flight HUD

#### ‚ö†Ô∏è Testing Status

**Tested scenarios:**
- ‚úÖ Singleplayer dragon flight
- ‚úÖ Multiplayer dragon flight (DragonSurvival on server)
- ‚úÖ HUD display mode switching
- ‚úÖ Velocity smoothing (FIR filter)

**Untested/Partially tested:**
- ‚ö†Ô∏è Server with mixed dragon/human players
- ‚ö†Ô∏è Dragon flight with elytra equipped
- ‚ö†Ô∏è Compatibility with other flight mods (Do A Barrel Roll, etc.)
- ‚ö†Ô∏è Long-term stability in production servers

#### ‚ö†Ô∏è Technical Limitations

1. **Velocity smoothing delay**
   - FIR low-pass filter introduces ~0.25 second delay
   - This is intentional to prevent HUD flickering
   - **Trade-off:** Smooth display vs. real-time accuracy
   - **Adjustment:** Modify `velocityFilterAlpha` in code (0.1-0.3 range)

2. **Reflection-based compatibility**
   - Uses reflection to access DragonSurvival internals
   - May break if DragonSurvival API changes
   - **Risk:** Updates to DragonSurvival may require updates to this fork

3. **Flight state detection**
   - Dragon flight uses `FlightData.areWingsSpread` + `hasFlight`
   - Additional conditions: not on ground, not in water/lava, not passenger
   - May not detect edge cases (spectator mode, creative flight, etc.)

#### ‚ö†Ô∏è Known Bugs

| Issue | Severity | Workaround |
|-------|----------|------------|
| HUD flickering during rapid flight state changes | Low | FIR filter reduces but doesn't eliminate |
| Velocity display lag (~0.25s) | Low | Intentional design trade-off |
| Server sync delay for dragon flight state | Medium | Depends on server tick rate |
| Possible incompatibility with other flight mods | Unknown | Test before deploying |

### For Maintainers

#### Code Changes

This fork modifies the following core components:

1. **`AirDataComputer.kt`**
   - Added `DragonSurvivalCompat.isDragonFlying()` to flight detection
   - Implemented FIR low-pass filter for velocity smoothing

2. **`HudDisplayDataComputer.kt`**
   - Added independent FIR filter for HUD velocity data
   - Ensures consistency with `AirDataComputer`

3. **`FAConfig.kt`**
   - Updated `display` property to use compound flight detection

4. **`DragonSurvivalCompat.kt`** (new)
   - Reflection-based compatibility layer
   - Detects dragon flight state without hard dependency

#### Parameter Tuning

**Velocity Filter (FIR Low-pass)**
```kotlin
// AirDataComputer.kt & HudDisplayDataComputer.kt
private val velocityFilterAlpha = 0.2  // Adjust this value
```

| Alpha | Cut-off Frequency | Delay | Use Case |
|-------|-------------------|-------|----------|
| 0.1 | ~0.35 Hz | ~0.5s | Maximum smoothness |
| **0.2** | **~0.8 Hz** | **~0.25s** | **Recommended (balanced)** |
| 0.3 | ~1.4 Hz | ~0.15s | Maximum responsiveness |

**Dragon Flight Detection**
```kotlin
// DragonSurvivalCompat.kt
val isDragonFlying = isDragon && hasFlight && areWingsSpread && 
                     !onGround && !inWater && !inLava && !isPassenger
```

#### Testing Checklist

Before merging or releasing:

- [ ] Singleplayer dragon flight HUD
- [ ] Multiplayer dragon flight HUD
- [ ] Elytra flight still works
- [ ] Human player (no dragon) HUD works
- [ ] Flight state transitions (ground ‚Üî air)
- [ ] Velocity display stability
- [ ] No console errors on startup
- [ ] Server compatibility test

#### Reporting Issues

When reporting bugs, please include:

1. Mod versions (FlightAssistant, DragonSurvival, etc.)
2. Loader (NeoForge/Fabric) and version
3. Minecraft version
4. Singleplayer or multiplayer
5. Log file (especially DragonSurvival compatibility logs)
6. Steps to reproduce

---

## Credits

- **Original FlightAssistant:** [Octol1ttle](https://github.com/Octol1ttle/FlightAssistant)
- **DragonSurvival:** [DragonSurvival Team](https://github.com/DragonSurvivalTeam/DragonSurvival)
- **This Fork:** Community contribution for DragonSurvival compatibility

## License

This fork inherits the LGPLv3 license from the original FlightAssistant mod.